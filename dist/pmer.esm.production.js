var e=0;var n=new Error("PMER_POST_MESSAGE_TIMEOUT");var t="PMER_MESSAGE_IDENT";function r(e){return"PMER_REPLY::".concat(e)}function i(e){return e.window===window}function o(e,n,t,r){if(i(e)){e.postMessage(n,t||"*",r)}else{e.postMessage(n,r)}}window.addEventListener("unhandledrejection",function(e){if(e.reason===n){e.preventDefault()}});function a(i,a,f,u,c){return new Promise(function(d,_){var v=e++;var E;if(Array.isArray(u)){var p=[u];c=p[0];u=p[1]}o(i,{__ident__:t,id:v,type:a,message:f},u,c);var w=s(r(a),function(e){clearTimeout(E);if(typeof e==="object"&&typeof e.then==="function"){e.then(d,_)}else{d(e)}},v);E=setTimeout(function(){w();_(n)},60*1e3)})}function f(e,n,i){function a(a){if(typeof a.data==="object"){var f=a.data,s=f.id,u=f.type,c=f.message,d=f.__ident__;if(!Array.isArray(e)){e=[e]}if(d===t&&e.some(function(e){return e==="*"||e===u})&&(!i||s===i)){var _=n(c,a);if(typeof _!=="undefined"&&a.source){o(a.source,{__ident__:t,id:i,type:r(u),message:_},a.origin)}}}}function f(){window.removeEventListener("message",a,false)}window.addEventListener("message",a,false);return f}function s(e,n,t){var r=f(e,function(){r();return n.apply(void 0,arguments)},t);return r}export{t as PMER_IDENT,e as PMER_MESSAGE_ID,n as PMER_UNHANDLE_REJECTION,f as addListener,s as addListenerOnce,a as postMessage};
