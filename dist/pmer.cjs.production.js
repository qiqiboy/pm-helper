"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.PMER_MESSAGE_ID=0;var e=new Error("PMER_POST_MESSAGE_TIMEOUT");var n="PMER_MESSAGE_IDENT";function t(e){return"PMER_REPLY::".concat(e)}function r(e){return e.window===window}function o(e,n,t,o){if(r(e)){e.postMessage(n,t||"*",o)}else{e.postMessage(n,o)}}window.addEventListener("unhandledrejection",function(n){if(n.reason===e){n.preventDefault()}});function i(r,i,s,u,f){return new Promise(function(d,c){var _=exports.PMER_MESSAGE_ID++;var E;if(Array.isArray(u)){var p=[u];f=p[0];u=p[1]}o(r,{__ident__:n,id:_,type:i,message:s},u,f);var v=a(t(i),function(e){clearTimeout(E);d(e)},_);E=setTimeout(function(){v();c(e)},60*1e3)})}function s(e,r,i){function s(s){if(typeof s.data==="object"){var a=s.data,u=a.id,f=a.type,d=a.message,c=a.__ident__;if(!Array.isArray(e)){e=[e]}if(c===n&&e.some(function(e){return e==="*"||e===f})&&(!i||u===i)){var _=r(d,s);if(typeof _!=="undefined"&&s.source){var E=function e(r){o(s.source,{__ident__:n,id:i,type:t(f),message:r},s.origin)};if(typeof _==="object"&&typeof _.then==="function"){_.then(E)}else{E(_)}}}}}function a(){window.removeEventListener("message",s,false)}window.addEventListener("message",s,false);return a}function a(e,n,t){var r=s(e,function(){r();return n.apply(void 0,arguments)},t);return r}exports.PMER_IDENT=n;exports.PMER_UNHANDLE_REJECTION=e;exports.addListener=s;exports.addListenerOnce=a;exports.postMessage=i;
